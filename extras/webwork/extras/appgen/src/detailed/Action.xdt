<XDtTagDef:tagDef namespace="Form" handler="org.example.antbook.xdoclet.FormTagsHandler"/>package <XDtForm:parentPackageName/>.webapp.action;

import java.util.List;

import <XDtPackage:packageName/>.<XDtClass:className/>;
import <XDtForm:parentPackageName/>.service.<XDtClass:className/>Manager;

public class <XDtClass:className/>Action extends BaseAction {
    private <XDtClass:className/> <XDtForm:classNameLower/>;
    private List <XDtForm:classNameLower/>s;
    private String <XDtMethodEx:idField getType="propertyName"/>;
    private <XDtClass:className/>Manager <XDtForm:classNameLower/>Manager;

    public void <XDtMethodEx:idField getType="setterName"/>(String <XDtMethodEx:idField getType="propertyName"/>) {
        this.<XDtMethodEx:idField getType="propertyName"/> = <XDtMethodEx:idField getType="propertyName"/>;
    }

    public void set<XDtClass:className/>Manager(<XDtClass:className/>Manager manager) {
        this.<XDtForm:classNameLower/>Manager = manager;
    }

    public <XDtClass:className/> get<XDtClass:className/>() {
        return <XDtForm:classNameLower/>;
    }

    public void set<XDtClass:className/>(<XDtClass:className/> <XDtForm:classNameLower/>) {
        this.<XDtForm:classNameLower/> = <XDtForm:classNameLower/>;
    }

    public String delete() {
        <XDtForm:classNameLower/>Manager.remove<XDtClass:className/>(String.valueOf(<XDtForm:classNameLower/>.<XDtMethodEx:idField getType="getterName"/>()));
        saveMessage(getText("<XDtForm:classNameLower/>.deleted"));

        return SUCCESS;
    }

    public String edit() {
        if (<XDtMethodEx:idField getType="propertyName"/> != null) {
            <XDtForm:classNameLower/> = <XDtForm:classNameLower/>Manager.get<XDtClass:className/>(<XDtMethodEx:idField getType="propertyName"/>);
        } else {
            <XDtForm:classNameLower/> = new <XDtClass:className/>();
        }

        return SUCCESS;
    }

    public String save() throws Exception {
        if (cancel != null) {
            return "cancel";
        }

        if (delete != null) {
            return delete();
        }

        boolean isNew = (<XDtForm:classNameLower/>.<XDtMethodEx:idField getType="getterName"/>() == null);

        <XDtForm:classNameLower/>Manager.save<XDtClass:className/>(<XDtForm:classNameLower/>);

        String key = (isNew) ? "<XDtForm:classNameLower/>.added" : "<XDtForm:classNameLower/>.updated";
        saveMessage(getText(key));

        if (!isNew) {
            return INPUT;
        } else {
            return SUCCESS;
        }
    }

    public List get<XDtClass:className/>s() {
        return <XDtForm:classNameLower/>s;
    }

    public String list() {
        <XDtForm:classNameLower/>s = <XDtForm:classNameLower/>Manager.get<XDtClass:className/>s(new <XDtClass:className/>());

        return SUCCESS;
    }
}
